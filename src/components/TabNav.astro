---
/**
 * TabNav - Tabbed navigation component for switching between views
 * Uses aria-controls and aria-selected for accessibility
 */
export interface Tab {
  id: string;
  label: string;
  icon?: string;
  badge?: number | string;
}

export interface Props {
  tabs: Tab[];
  activeTab?: string;
  class?: string;
  /** Style variant */
  variant?: 'default' | 'pills' | 'underline';
}

const {
  tabs,
  activeTab = tabs[0]?.id,
  class: className = '',
  variant = 'default',
} = Astro.props;

const navClass = ['tab-nav', `tab-nav-${variant}`, className].filter(Boolean).join(' ');
---

<nav class={navClass} role="tablist">
  {tabs.map((tab) => (
    <button
      type="button"
      role="tab"
      id={`tab-${tab.id}`}
      aria-controls={`panel-${tab.id}`}
      aria-selected={tab.id === activeTab}
      class:list={['tab-item', { active: tab.id === activeTab }]}
      data-tab={tab.id}
    >
      {tab.icon && <span class="tab-icon">{tab.icon}</span>}
      <span class="tab-label">{tab.label}</span>
      {tab.badge !== undefined && (
        <span class="tab-badge">{tab.badge}</span>
      )}
    </button>
  ))}
</nav>

<style>
  .tab-nav {
    display: flex;
    gap: var(--space-1);
    border-bottom: 1px solid var(--border-subtle);
    margin-bottom: var(--space-6);
  }

  .tab-item {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    border: none;
    background: none;
    color: var(--color-text-muted);
    font: inherit;
    font-size: var(--text-sm);
    font-weight: 500;
    cursor: pointer;
    position: relative;
    transition: color var(--transition-fast);
  }

  .tab-item:hover {
    color: var(--color-text);
  }

  .tab-item.active {
    color: var(--color-primary);
  }

  .tab-item.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--color-primary);
    border-radius: 2px 2px 0 0;
  }

  .tab-icon {
    font-size: 1.1em;
  }

  .tab-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    padding: 0 var(--space-1);
    height: 20px;
    font-size: var(--text-xs);
    font-weight: 600;
    background: var(--border-default);
    color: var(--color-text-secondary);
    border-radius: var(--radius-full);
  }

  .tab-item.active .tab-badge {
    background: var(--color-primary);
    color: white;
  }

  /* Pills variant */
  .tab-nav-pills {
    border-bottom: none;
    gap: var(--space-2);
    background: var(--color-surface);
    padding: var(--space-1);
    border-radius: var(--radius-lg);
    width: fit-content;
  }

  .tab-nav-pills .tab-item {
    border-radius: var(--radius);
    padding: var(--space-2) var(--space-4);
  }

  .tab-nav-pills .tab-item.active {
    background: var(--color-bg);
    box-shadow: var(--shadow-sm);
  }

  .tab-nav-pills .tab-item.active::after {
    display: none;
  }

  /* Underline variant */
  .tab-nav-underline {
    gap: var(--space-4);
  }

  .tab-nav-underline .tab-item {
    padding: var(--space-3) 0;
  }
</style>
